
<!DOCTYPE html>
<html lang="ko">
<head>
 <meta charset="UTF-8">
 <title>오목</title>
 <style>
 td {
 border: 1px solid black;
 width: 24px;
 height: 24px;
 text-align: center;
 }
 </style>
 <script>

let playerTurn = 'p1'
let playerSton = 'O'
let win = false;

window.addEventListener('DOMContentLoaded', function(){    
    let board = document.getElementById('board')
    let restart = document.getElementById('restart')
    let playerLabel = document.getElementsByClassName('player-label')
    let message = document.getElementById('message')

    restart.onclick = function(){
        location.reload()
    }

    board.onclick = function(e){

    if(win == true){
        return
    }

    if(e.target.innerText != ''){
        return
    }

    //돌 놓기
    if(playerTurn == 'p1'){
        e.target.innerText = playerSton
    }else if (playerTurn == 'p2'){
        e.target.innerText = playerSton
    }

    //board의 tr td요소 배열로 전환
    let boardTable =
    Array.from(document.querySelectorAll('#board tr'), tr =>
        Array.from(tr.querySelectorAll('td'), td =>
        td.textContent
        )
    )

    let curRowIdx = e.target.parentElement.rowIndex
    let curColIdx = e.target.cellIndex

    console.log(`현재 돌 위치 : (${curRowIdx}, ${curColIdx})`)

    let cnt1 = 0;
    let cnt2 = 0; 

    /**
     * ↑↓방향 같은 돌 개수 체크
     */
    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx+i][curColIdx] == playerSton){
            cnt1++
        }
        else {
            break
        }
    }


    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx-i][curColIdx] == playerSton){
            cnt2++
        }
        else {
            break
        }
    }

    if(cnt1 + cnt2 == 4){
        win = true
    }


    cnt1 = 0;
    cnt2 = 0; 

    /**
     * ↙↗방향 같은 돌 개수 체크
     */
    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx+i][curColIdx-i] == playerSton){
            cnt1++
        }
        else {
            break
        }
    }

    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx-i][curColIdx+i] == playerSton){
            cnt2++
        }
        else {
            break
        }
    }

    if(cnt1 + cnt2 == 4){
        win = true
    }


    cnt1 = 0;
    cnt2 = 0; 

    /**
     * ↖↘방향 같은 돌 개수 체크
     */
    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx-i][curColIdx-i] == playerSton){
            cnt1++
        }
        else {
            break
        }
    }

    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx+i][curColIdx+i] == playerSton){
            cnt2++
        }
        else {
            break
        }
    }

    if(cnt1 + cnt2 == 4){
        win = true
    }


    cnt1 = 0;
    cnt2 = 0; 


    /**
     * ←→방향 같은 돌 개수 체크
     */
    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx][curColIdx-i] == playerSton){
            cnt1++
        }
        else {
            break
        }
    }

    for (let i = 1; i < 5; i++) {
        if(boardTable[curRowIdx][curColIdx+i] == playerSton){
            cnt2++
        }
        else {
            break
        }
    }

    if(cnt1 + cnt2 == 4){
        win = true
    }

    console.log(`win : ${win}`)

    if(win == true){
        if(playerTurn == 'p1'){
            message.innerText = 'player1 플레이어가 승리하였습니다.'
        }else {
            message.innerText = 'player2 플레이어가 승리하였습니다.'
        }
    } else {
        //턴 바꾸기
        if(playerTurn == 'p1'){
            playerTurn = 'p2'
        }else{
            playerTurn = 'p1'
        }

        if(playerTurn == 'p1'){
            playerLabel[0].style.backgroundColor = 'red'
            playerLabel[1].style.backgroundColor = 'white'
            playerSton = 'O'
            message.innerText = 'player1 차례입니다.'
        }else if (playerTurn == 'p2'){
            playerLabel[0].style.backgroundColor = 'white'
            playerLabel[1].style.backgroundColor = 'red'
            playerSton = 'X'
            message.innerText = 'player2 차례입니다.'
        }
    }
    
};
});



</script>
</head>
<body>
<h1>오목</h1>
<div>
 <span class="player-label" style="background-color: red">player1: O</span>, <span class="player-label">player2:
X</span>
</div>
<button id="restart">재시작</button>
<table id="board">

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>

<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
    ><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    
    <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
    ><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    
    <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
    ><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    
    <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
    ><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    
    <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
    ><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    
    <tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td
    ><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
    </table>
    <div id="message">player1 차례입니다.</div>
    </body>
    </html>